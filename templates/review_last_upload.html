{% extends "base.html" %}

{% block title %}Review Last Upload - Budget App{% endblock %}

{% block content %}
<div style="margin-bottom: 20px;">
  <a href="{{ url_for('main.home') }}" style="text-decoration: none; color: #667eea; font-weight: bold;">
    â† Back to Dashboard
  </a>
</div>

<h1>Review Last Upload</h1>

<form method="post" action="{{ url_for('transactions.update_categories') }}">
  <table border="1" cellpadding="4" cellspacing="0">
    <thead>
      <tr>
        <th>Date</th>
        <th>Description</th>
        <th>Account</th>
        <th>Amount</th>
        <th>Category</th>
      </tr>
    </thead>
    <tbody>
      {% for tx in transactions %}
      <tr>
        <td>{{ tx.date }}</td>
        <td>{{ tx.description }}</td>
        <td>{{ tx.account }}</td>
        <td>{{ "%.2f"|format(tx.amount) }}</td>
        <td>
          <select name="category_{{ tx.id }}" aria-label="Category for {{ tx.description }}">
            <option value="">Uncategorised</option>
            {% for name in category_names %}
              <option value="{{ name }}" {% if tx.category == name %}selected{% endif %}>
                {{ name }}
              </option>
            {% endfor %}
          </select>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <p style="margin-top: 20px;">
    <button type="submit" name="action" value="save" style="padding: 8px 16px; margin-right: 10px;">
      ğŸ’¾ Save Changes
    </button>
    <button type="submit" name="action" value="send_to_claude" style="padding: 8px 16px; margin-right: 10px;">
      ğŸ¤– Save & Send to Claude
    </button>
    <button type="submit" name="action" value="reset_to_uncategorised" style="padding: 8px 16px;">
      ğŸ”„ Reset All
    </button>
  </p>
</form>

<div style="margin-top: 20px;">
  <a href="{{ url_for('main.home') }}" style="text-decoration: none; color: #667eea; font-weight: bold;">
    â† Back to Dashboard
  </a>
</div>
{% endblock %}
